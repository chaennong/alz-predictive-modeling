pred <-  ifelse(prob > threshold, 1, 0)
cm <- table(Predicted = pred, Actual = y_test)
list(AUC = roc_obj,
THreshold = threshold,
ConfusionMatrix = cm)
}
evaluate_glmnet(lasso_model, test, lambda = lasso_model$lambda.min)
elasticnet_model <- perform_penalized_modeling(train, alpha = 0.5)
evaluate_glmnet(elasticnet_model, test, lambda = elasticnet_model$lambda.min)
run_baseline_experiment <- function(train, test) {
model <- perform_baseline_modeling(train)
eval <- evaluate_glm(model, test)
list (
model = model,
evaluation = eval
)
}
run_baseline_experiment(train, test)
split_x_y <- function(data) {
list(
x <- model.matrix(Diagnosis~., data =
data)[,-1],
y <- data$Diagnosis
)
}
train_x <- split_x_y(train)$x
train_y <- split_x_y(train)$y
test_x <- split_x_y(test)$x
test_y <- split_x_y(test)$y
split_x_y(train)
split_x_y <- function(data) {
list(
x = model.matrix(Diagnosis~., data =
data)[,-1],
y = data$Diagnosis
)
train_x <- split_x_y(train)$x
train_y <- split_x_y(train)$y
test_x <- split_x_y(test)$x
test_y <- split_x_y(test)$y
split_x_y <- function(data) {
list(
x = model.matrix(Diagnosis~., data =
data)[,-1],
y = data$Diagnosis
)
}
train_x <- split_x_y(train)$x
train_y <- split_x_y(train)$y
test_x <- split_x_y(test)$x
test_y <- split_x_y(test)$y
split_x_y <- function(data) {
list(
x = model.matrix(Diagnosis~., data =
data)[,-1],
y = data$Diagnosis
)
}
x_train <- split_x_y(train)$x
y_train <- split_x_y(train)$y
x_test <- split_x_y(test)$x
y_test <- split_x_y(test)$y
run_penalized_experiment <- function(x_train, y_train, x_test, y_test, alpha) {
cv_model <- perform_penalized_modeling(x_train, y_train, alpha)
best_lambda <- cv_model$lambda.min
model <- glmnet(x_train, y_train, family = "binomial", alpha = alpha, lambda = best_lambda)
eval <- evaluate_glmnet(model, x_test, y_test, lambda = best_lambda)
list(
model = model,
evaluation = eval
)
}
run_penalized_experiment(x_train, y_train, x_test, y_test, alpha = 1)
library(MASS)
library(glmnet)
library(caret)
library(Metrics)
library(pROC)
setwd("/Users/chaeeunshin/Desktop/AlzAnalysis/data")
data <- readRDS('data.rds')
data$Gender <- as.factor(data$Gender)
data$Ethnicity <- as.factor(data$Ethnicity)
data$EducationLevel <- as.factor(data$EducationLevel)
data$Smoking <- as.factor(data$Smoking)
data$FamilyHistoryAlzheimers <- as.factor(data$FamilyHistoryAlzheimers)
data$CardiovascularDisease <- as.factor(data$CardiovascularDisease)
data$Diabetes <- as.factor(data$Diabetes)
data$Depression <- as.factor(data$Depression)
data$HeadInjury <- as.factor(data$HeadInjury)
data$Hypertension <- as.factor(data$Hypertension)
data$MemoryComplaints <- as.factor(data$MemoryComplaints)
data$BehavioralProblems <- as.factor(data$BehavioralProblems)
data$Confusion <- as.factor(data$Confusion)
data$Disorientation <- as.factor(data$Disorientation)
data$PersonalityChanges <- as.factor(data$PersonalityChanges)
data$DifficultyCompletingTasks <- as.factor(data$DifficultyCompletingTasks)
data$Forgetfulness <- as.factor(data$Forgetfulness)
data$Diagnosis <- as.factor(data$Diagnosis)
split_data <- function(data, seed = 123) {
set.seed(seed)
idx <- createDataPartition(data$Diagnosis, p = 0.7, list = FALSE)
list(
train = data[idx,],
test = data[-idx,]
)
}
data <- data[,2:34]
train <- split_data(data)$train
test <- split_data(data)$test
split_x_y <- function(data) {
list(
x = model.matrix(Diagnosis~., data =
data)[,-1],
y = data$Diagnosis
)
}
x_train <- split_x_y(train)$x
y_train <- split_x_y(train)$y
x_test <- split_x_y(test)$x
y_test <- split_x_y(test)$y
perform_baseline_modeling <- function(train) {
set.seed(123)
glm(Diagnosis ~ ., data = train, family = binomial)
}
baseline_model <- perform_baseline_modeling(train, test)
perform_baseline_modeling <- function(train) {
set.seed(123)
glm(Diagnosis ~ ., data = train, family = binomial)
}
baseline_model <- perform_baseline_modeling(train)
summary(baseline_model)
perform_stepwise_modeling <- function(train) {
full_model <- glm(Diagnosis~., data = train, family = binomial)
step(full_model, direction = "both", trace= FALSE)
}
stepwise_model <- perform_stepwise_modeling(train, test)
perform_stepwise_modeling <- function(train) {
full_model <- glm(Diagnosis~., data = train, family = binomial)
step(full_model, direction = "both", trace= FALSE)
}
stepwise_model <- perform_stepwise_modeling(train)
summary(stepwise_model)
perform_penalized_modeling <- function(x, y, alpha = 1) {
set.seed(123)
cv.glmnet(x, y, family = "binomial", alpha = alpha)
}
lasso_model <- perform_penalized_modeling(x_train, y_train, alpha = 1)
elasticnet_model <- perform_penalized_modeling(x_train, y_train, alpha = 0.5)
evaluate_glm <- function(model, test, threshold = NULL) {
prob_test <- predict(model, newdata = test, type = "response")
roc_obj <- roc(test$Diagnosis, prob_test)
auc_val <- auc(roc_obj)
threshold <- as.numeric(coords(roc_obj, "best", ret= "threshold", best.method = "youden"))
pred_class <- ifelse(prob_test > threshold, 1, 0)
cm <- table(Predicted = pred_class, Actual = test$Diagnosis)
list(AUC = auc_val,
Threshold = threshold,
ConfusionMatrix = cm)
}
evaluate_glm(baseline_model, test)
evaluate_glmnet <- function(model, x, y, lambda) {
prob <- predict(model, newx = x, s = lambda, type = "response")[,1]
roc_obj <- roc(y, prob)
auc_val <- auc(roc_obj)
threshold <- as.numeric(coords(roc_obj, "best", ret = "threshold", best.method = "youden"))
pred <-  ifelse(prob > threshold, 1, 0)
cm <- table(Predicted = pred, Actual = y)
list(AUC = roc_obj,
THreshold = threshold,
ConfusionMatrix = cm)
}
evaluate_glmnet(lasso_model, x_test, y_test, lambda = lasso_model$lambda.min)
evaluate_glmnet(elasticnet_model, x_test, y_test, lambda = elasticnet_model$lambda.min)
run_baseline_experiment <- function(train, test) {
model <- perform_baseline_modeling(train)
eval <- evaluate_glm(model, test)
list (
model = model,
evaluation = eval
)
}
run_baseline_experiment(train, test)
run_penalized_experiment <- function(x_train, y_train, x_test, y_test, alpha) {
cv_model <- perform_penalized_modeling(x_train, y_train, alpha)
best_lambda <- cv_model$lambda.min
model <- glmnet(x_train, y_train, family = "binomial", alpha = alpha, lambda = best_lambda)
eval <- evaluate_glmnet(model, x_test, y_test, lambda = best_lambda)
list(
model = model,
evaluation = eval
)
}
run_penalized_experiment(x_train, y_train, x_test, y_test, alpha = 1)
run_penalized_experiment <- function(x_train, y_train, x_test, y_test, alpha) {
cv_model <- perform_penalized_modeling(x_train, y_train, alpha)
best_lambda <- cv_model$lambda.min
model <- glmnet(x_train, y_train, family = "binomial", alpha = alpha, lambda = best_lambda)
eval <- evaluate_glmnet(model, x_test, y_test, lambda = best_lambda)
list(
model = model,
evaluation = eval
)
}
run_penalized_experiment(x_train, y_train, x_test, y_test, alpha = 1)
run_penalized_experiment(x_train, y_train, x_test, y_test, alpha = 0.5)
library(MASS)
library(glmnet)
library(caret)
library(Metrics)
library(pROC)
setwd("/Users/chaeeunshin/Desktop/AlzAnalysis/data")
data <- readRDS('data.rds')
data$Gender <- as.factor(data$Gender)
data$Ethnicity <- as.factor(data$Ethnicity)
data$EducationLevel <- as.factor(data$EducationLevel)
data$Smoking <- as.factor(data$Smoking)
data$FamilyHistoryAlzheimers <- as.factor(data$FamilyHistoryAlzheimers)
data$CardiovascularDisease <- as.factor(data$CardiovascularDisease)
data$Diabetes <- as.factor(data$Diabetes)
data$Depression <- as.factor(data$Depression)
data$HeadInjury <- as.factor(data$HeadInjury)
data$Hypertension <- as.factor(data$Hypertension)
data$MemoryComplaints <- as.factor(data$MemoryComplaints)
data$BehavioralProblems <- as.factor(data$BehavioralProblems)
data$Confusion <- as.factor(data$Confusion)
data$Disorientation <- as.factor(data$Disorientation)
data$PersonalityChanges <- as.factor(data$PersonalityChanges)
data$DifficultyCompletingTasks <- as.factor(data$DifficultyCompletingTasks)
data$Forgetfulness <- as.factor(data$Forgetfulness)
data$Diagnosis <- as.factor(data$Diagnosis)
split_data <- function(data, seed = 123) {
set.seed(seed)
idx <- createDataPartition(data$Diagnosis, p = 0.7, list = FALSE)
list(
train = data[idx,],
test = data[-idx,]
)
}
data <- data[,2:34]
train <- split_data(data)$train
test <- split_data(data)$test
split_x_y <- function(data) {
list(
x = model.matrix(Diagnosis~., data =
data)[,-1],
y = data$Diagnosis
)
}
x_train <- split_x_y(train)$x
y_train <- split_x_y(train)$y
x_test <- split_x_y(test)$x
y_test <- split_x_y(test)$y
perform_baseline_modeling <- function(train) {
set.seed(123)
glm(Diagnosis ~ ., data = train, family = binomial)
}
library(MASS)
library(glmnet)
library(caret)
library(Metrics)
library(pROC)
setwd("/Users/chaeeunshin/Desktop/AlzAnalysis/data")
data <- readRDS('data.rds')
data$Gender <- as.factor(data$Gender)
data$Ethnicity <- as.factor(data$Ethnicity)
data$EducationLevel <- as.factor(data$EducationLevel)
data$Smoking <- as.factor(data$Smoking)
data$FamilyHistoryAlzheimers <- as.factor(data$FamilyHistoryAlzheimers)
data$CardiovascularDisease <- as.factor(data$CardiovascularDisease)
data$Diabetes <- as.factor(data$Diabetes)
data$Depression <- as.factor(data$Depression)
data$HeadInjury <- as.factor(data$HeadInjury)
data$Hypertension <- as.factor(data$Hypertension)
data$MemoryComplaints <- as.factor(data$MemoryComplaints)
data$BehavioralProblems <- as.factor(data$BehavioralProblems)
data$Confusion <- as.factor(data$Confusion)
data$Disorientation <- as.factor(data$Disorientation)
data$PersonalityChanges <- as.factor(data$PersonalityChanges)
data$DifficultyCompletingTasks <- as.factor(data$DifficultyCompletingTasks)
data$Forgetfulness <- as.factor(data$Forgetfulness)
data$Diagnosis <- as.factor(data$Diagnosis)
split_data <- function(data, seed = 123) {
set.seed(seed)
idx <- createDataPartition(data$Diagnosis, p = 0.7, list = FALSE)
list(
train = data[idx,],
test = data[-idx,]
)
}
data <- data[,2:34]
train <- split_data(data)$train
test <- split_data(data)$test
split_x_y <- function(data) {
list(
x = model.matrix(Diagnosis~., data =
data)[,-1],
y = data$Diagnosis
)
}
x_train <- split_x_y(train)$x
y_train <- split_x_y(train)$y
x_test <- split_x_y(test)$x
y_test <- split_x_y(test)$y
fit_baseline <- function(train) {
set.seed(123)
glm(Diagnosis ~ ., data = train, family = binomial)
}
fit_stepwise <- function(train) {
full_model <- glm(Diagnosis~., data = train, family = binomial)
step(full_model, direction = "both", trace= FALSE)
}
stepwise_model <- perform_stepwise_modeling(train)
fit_stepwise <- function(train) {
full_model <- glm(Diagnosis~., data = train, family = binomial)
step(full_model, direction = "both", trace= FALSE)
}
stepwise_model <- fit_stepwise(train)
summary(stepwise_model)
fit_penalized_cv <- function(x, y, alpha = 1) {
set.seed(123)
cv.glmnet(x, y, family = "binomial", alpha = alpha, standardize = TRUE)
}
evaluate_glm <- function(model, test, threshold = NULL) {
prob_test <- predict(model, newdata = test, type = "response")
roc_obj <- roc(test$Diagnosis, prob_test)
auc_val <- auc(roc_obj)
threshold <- as.numeric(coords(roc_obj, "best", ret= "threshold", best.method = "youden"))
pred_class <- ifelse(prob_test > threshold, 1, 0)
cm <- table(Predicted = pred_class, Actual = test$Diagnosis)
list(AUC = auc_val,
Threshold = threshold,
ConfusionMatrix = cm)
}
evaluate_glmnet <- function(model, x, y, lambda) {
prob <- as.numeric(predict(model, newx = x, s = lambda, type = "response"))
roc_obj <- roc(y, prob, quiet = TRUE)
auc_val <- as.numeric(auc(roc_obj))
threshold <- as.numeric(coords(roc_obj, "best", ret = "threshold", best.method = "youden"))
pred <-  ifelse(prob > threshold, 1, 0)
cm <- table(Predicted = pred, Actual = y)
list(AUC = roc_obj,
Threshold = threshold,
ConfusionMatrix = cm)
}
run_baseline_experiment <- function(train, test) {
model <- perform_baseline_modeling(train)
eval <- evaluate_glm(model, test)
list (
model = model,
evaluation = eval
)
}
run_baseline_experiment(train, test)
run_baseline_experiment <- function(train, test) {
model <- fit_baseline(train)
eval <- evaluate_glm(model, test)
list (
model = model,
evaluation = eval
)
}
run_baseline_experiment(train, test)
run_penalized_experiment <- function(x_train, y_train, x_test, y_test, alpha) {
set.seed(123)
cv_model <- fit_penalized_cv(x_train, y_train, alpha)
best_lambda <- cv_model$lambda.min
final_model <- glmnet(x_train, y_train, family = "binomial", alpha = alpha, lambda = best_lambda, standardize = TRUE)
eval <- evaluate_glmnet(final_model, x_test, y_test, lambda = best_lambda)
list(
model = final_model,
evaluation = eval,
lambda = best_lambda,
alpha = alpha
)
}
run_penalized_experiment(x_train, y_train, x_test, y_test, alpha = 1)
run_penalized_experiment(x_train, y_train, x_test, y_test, alpha = 0.5)
baseline_result <- run_baseline_experiment(trian, test)
baseline_result <- run_baseline_experiment(train, test)
cat("\nResult for baseline model: \n", baseline_result)
View(baseline_result)
baseline_result <- run_baseline_experiment(train, test)
cat("\nBaseline model: \n", baseline_result$model)
baseline_result <- run_baseline_experiment(train, test)
baseline_model <- baseline_result$model
baseline_eval <- baseline_result$evaluation
cat("\nBaseline model: \n", baseline_model)
run_baseline_experiment(train, test)
run_penalized_experiment(x_train, y_train, x_test, y_test, alpha = 1)
run_penalized_experiment(x_train, y_train, x_test, y_test, alpha = 0.5)
setwd("/Users/chaeeunshin/Desktop/AlzAnalysis/data")
setwd("/Users/chaeeunshin/Desktop/alz-predictive-modeling/data")
data <- readRDS('data.rds')
View(data)
data <- data[,-c("PatientID", "DoctorInCharge")]
data <- read.csv("alzheimers_disease_data.csv")
View(data)
data$HeadInjury <- as.factor(data$HeadInjury)
preprocess <- function(data) {
data <- data %>% dplyr::select(-c(PatientID, DoctorInCharge))
data$Gender <- as.factor(data$Gender)
data$Ethnicity <- as.factor(data$Ethnicity)
data$EducationLevel <- as.factor(data$EducationLevel)
data$Smoking <- as.factor(data$Smoking)
data$FamilyHistoryAlzheimers <- as.factor(data$FamilyHistoryAlzheimers)
data$CardiovascularDisease <- as.factor(data$CardiovascularDisease)
data$Diabetes <- as.factor(data$Diabetes)
data$Depression <- as.factor(data$Depression)
data$HeadInjury <- as.factor(data$HeadInjury)
data$Hypertension <- as.factor(data$Hypertension)
data$MemoryComplaints <- as.factor(data$MemoryComplaints)
data$BehavioralProblems <- as.factor(data$BehavioralProblems)
data$Confusion <- as.factor(data$Confusion)
data$Disorientation <- as.factor(data$Disorientation)
data$PersonalityChanges <- as.factor(data$PersonalityChanges)
data$DifficultyCompletingTasks <- as.factor(data$DifficultyCompletingTasks)
data$Forgetfulness <- as.factor(data$Forgetfulness)
data$Diagnosis <- as.factor(data$Diagnosis)
write.csv(data, "alzheimers_disease_data_processed.csv")
}
preprocess(data)
library(dplyr)
preprocess(data)
?pROC
source("R/preprocess.R")
source("/R/preprocess.R")
getwd()
setwd("/Users/chaeeunshin/Desktop/alz-predictive-modeling")
source("/R/preprocess.R")
source("/R/preprocess.R")
source("preprocess.R")
source("R/preprocess.R")
source(here("R/preprocess.R"))
source("R/preprocess.R")
getwd()
install.packages("here")
source(here::here("R", "preprocess.R"))
source("R/preprocess.R")
source(here("R", "preprocess.R"))
library(here)
source(here("R", "preprocess.R"))
r_files <- list.files(here::here("R"), pattern = "\\.R$", full.names = TRUE)
sapply(r_files, source)
r_files <- list.files(here::here("R"), pattern = "\\.R$", full.names = TRUE)
sapply(r_files, source)
data <- read.csv(here("data", "alzheimer_data.csv"))
data <- read.csv(here("data", "alzheimers_disease_data.csv"))
data <- read.csv(here("data", "alzheimers_disease_data.csv"))
preprocess(data = data)
r_files <- list.files(here::here("R"), pattern = "\\.R$", full.names = TRUE)
sapply(r_files, source)
data <- read.csv(here("data", "alzheimers_disease_data.csv"))
data <- preprocess(data = data)
View(data)
train <- split_data(data)$train
train <- split_data(data)$train
test <- split_data(data)$test
test <- split_data(data)$test
test_x <- split_x_y(test)$x
test_y <- split_x_y(test)$y
train_x <- split_x_y(train)$x
train_y <- split_x_y(train)$y
run_baseline_experiment(train, test)
x_train <- split_x_y(train)$x
y_train <- split_x_y(train)$y
x_test <- split_x_y(test)$x
y_test <- split_x_y(test)$y
View(run_penalized_experiment)
run_penalized_experiment(x_train, y_train, x_test, y_test, alpha = 1)
r_files <- list.files(here::here("R"), pattern = "\\.R$", full.names = TRUE)
sapply(r_files, source)
run_penalized_experiment(x_train, y_train, x_test, y_test, alpha = 1)
# Elastic net
run_peralized_experiment(x_train, y_train, x_test, y_test, alpha = 0.5)
# Elastic net
run_penalized_experiment(x_train, y_train, x_test, y_test, alpha = 0.5)
r_files <- list.files(here::here("R"), pattern = "\\.R$", full.names = TRUE)
sapply(r_files, source)
data <- read.csv(here("data", "alzheimers_disease_data.csv"))
data <- preprocess(data = data)
train <- split_data(data)$train
test <- split_data(data)$test
x_train <- split_x_y(train)$x
y_train <- split_x_y(train)$y
x_test <- split_x_y(test)$x
y_test <- split_x_y(test)$y
run_baseline_experiment(train, test)
# LASSO
run_penalized_experiment(x_train, y_train, x_test, y_test, alpha = 1)
# Elastic net
run_penalized_experiment(x_train, y_train, x_test, y_test, alpha = 0.5)
fit_stepwise(train)
?stepAIC
r_files <- list.files(here::here("R"), pattern = "\\.R$", full.names = TRUE)
sapply(r_files, source)
data <- read.csv(here("data", "alzheimers_disease_data.csv"))
data <- preprocess(data = data)
train <- split_data(data)$train
test <- split_data(data)$test
x_train <- split_x_y(train)$x
y_train <- split_x_y(train)$y
x_test <- split_x_y(test)$x
y_test <- split_x_y(test)$y
run_experiment(train, test, "baseline")
run_experiment(train, test, "stepwise")
r_files <- list.files(here::here("R"), pattern = "\\.R$", full.names = TRUE)
sapply(r_files, source)
run_experiment(train, test, "stepwise")
# LASSO
run_penalized_experiment(x_train, y_train, x_test, y_test, alpha = 1)
# Elastic net
run_penalized_experiment(x_train, y_train, x_test, y_test, alpha = 0.5)
